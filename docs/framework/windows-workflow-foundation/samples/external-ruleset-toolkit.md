---
title: Externes RuleSet-Toolkit
ms.date: 03/30/2017
ms.assetid: a306d283-a031-475e-aa01-9ae86e7adcb0
ms.openlocfilehash: 510b70f7ebeda784dce4731bb4a08896ac2e8361
ms.sourcegitcommit: 160a88c8087b0e63606e6e35f9bd57fa5f69c168
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 03/09/2019
ms.locfileid: "57710042"
---
# <a name="external-ruleset-toolkit"></a><span data-ttu-id="8d496-102">Externes RuleSet-Toolkit</span><span class="sxs-lookup"><span data-stu-id="8d496-102">External Ruleset Toolkit</span></span>

<span data-ttu-id="8d496-103">Wenn Regeln innerhalb einer Workflowanwendung verwendet werden, sind die Regeln normalerweise ein Teil der Assembly.</span><span class="sxs-lookup"><span data-stu-id="8d496-103">Normally when rules are used within a workflow application, the rules are part of the assembly.</span></span> <span data-ttu-id="8d496-104">Bei einigen Szenarien möchten Sie die RuleSets eventuell getrennt von der Assembly aufbewahren, damit sie ohne erneutes Erstellen und Bereitstellen der Workflowassembly aktualisiert werden können.</span><span class="sxs-lookup"><span data-stu-id="8d496-104">In some scenarios, you may want to maintain the RuleSets separately from the assembly so that they can be updated without rebuilding and deploying the workflow assembly.</span></span> <span data-ttu-id="8d496-105">In diesem Beispiel können Sie RuleSets in einer Datenbank verwalten und bearbeiten und von einem Workflow zur Laufzeit auf diese RuleSets zugreifen.</span><span class="sxs-lookup"><span data-stu-id="8d496-105">This sample allows you to manage and edit RuleSets in a database and access those RuleSets from a workflow at runtime.</span></span> <span data-ttu-id="8d496-106">Dadurch ist es möglich, dass die ausgeführten Workflowinstanzen RuleSet-Änderungen automatisch integrieren.</span><span class="sxs-lookup"><span data-stu-id="8d496-106">This enables running workflow instances to automatically incorporate RuleSet changes.</span></span>

<span data-ttu-id="8d496-107">Das Beispiel für ein externes RuleSet-Toolkit enthält ein Windows Forms-basiertes Tool, das Sie zum Verwalten und Bearbeiten der RuleSet-Versionen in einer Datenbank verwenden können.</span><span class="sxs-lookup"><span data-stu-id="8d496-107">The External RuleSet Toolkit sample contains a Windows Forms-based tool that you can use to manage and edit RuleSet versions in a database.</span></span> <span data-ttu-id="8d496-108">Es bietet auch eine Aktivität und einen Hostdienst zum Ausführen dieser Regeln.</span><span class="sxs-lookup"><span data-stu-id="8d496-108">It also includes an activity and a host service for executing those rules.</span></span>

> [!NOTE]
> <span data-ttu-id="8d496-109">Dieses Beispiel erfordert [Microsoft SQL Server](https://go.microsoft.com/fwlink/?LinkId=96181).</span><span class="sxs-lookup"><span data-stu-id="8d496-109">This sample requires [Microsoft SQL Server](https://go.microsoft.com/fwlink/?LinkId=96181).</span></span>

<span data-ttu-id="8d496-110">Visual Studio bietet einen RuleSet-Editor als Teil von Windows Workflow Foundation (WF).</span><span class="sxs-lookup"><span data-stu-id="8d496-110">Visual Studio provides a RuleSet editor as part of the Windows Workflow Foundation (WF).</span></span> <span data-ttu-id="8d496-111">Sie können diesen Editor starten, indem Sie auf die `Policy`-Aktivität in einem Workflow doppelklicken. Dadurch wird das definierte RuleSet-Objekt in die dem Workflow zugeordnete RULES-Datei serialisiert (eine `Policy`-Aktivität führt eine RuleSet-Instanz für den Workflow aus).</span><span class="sxs-lookup"><span data-stu-id="8d496-111">You can start this editor by double-clicking the `Policy` activity in a workflow; it serializes the defined RuleSet object to the .rules file associated with the workflow (a `Policy` activity runs a RuleSet instance against the workflow).</span></span> <span data-ttu-id="8d496-112">Die RULES-Datei wird beim Erstellen des Workflowprojekts als Ressource in die Assembly kompiliert.</span><span class="sxs-lookup"><span data-stu-id="8d496-112">The .rules file is compiled into the assembly as a resource when you build the workflow project.</span></span>

<span data-ttu-id="8d496-113">Die Komponenten dieses Beispiel umfassen:</span><span class="sxs-lookup"><span data-stu-id="8d496-113">The components of this sample include:</span></span>

- <span data-ttu-id="8d496-114">Ein grafisches RuleSet-Benutzeroberflächentool, mit dem Sie RuleSet-Versionen in der Datenbank bearbeiten und verwalten können.</span><span class="sxs-lookup"><span data-stu-id="8d496-114">A RuleSet graphical user interface tool that you can use to edit and manage RuleSet versions in the database.</span></span>

- <span data-ttu-id="8d496-115">Einen RuleSet-Dienst, der auf der Hostanwendung konfiguriert wird und auf RuleSets aus der Datenbank zugreift.</span><span class="sxs-lookup"><span data-stu-id="8d496-115">A RuleSet service that is configured on the host application and accesses RuleSets from the database.</span></span>

- <span data-ttu-id="8d496-116">Eine `ExternalPolicy`-Aktivität, die ein RuleSet vom RuleSet-Dienst anfordert und das RuleSet für den Workflow ausführt.</span><span class="sxs-lookup"><span data-stu-id="8d496-116">An `ExternalPolicy` activity that requests a RuleSet from the RuleSet service and runs the RuleSet against the workflow.</span></span>

<span data-ttu-id="8d496-117">Die Interaktion der Komponenten ist in Abbildung 1 dargestellt.</span><span class="sxs-lookup"><span data-stu-id="8d496-117">The interaction of the components is shown in Figure 1.</span></span> <span data-ttu-id="8d496-118">In den nachfolgenden Abschnitten werden die einzelnen Komponenten beschrieben.</span><span class="sxs-lookup"><span data-stu-id="8d496-118">The sections that follow describe each component.</span></span>

<span data-ttu-id="8d496-119">![Übersicht über externen RuleSet-Beispiel](./media/rulesettoolkitsampleoverview.gif "RuleSetToolkitSampleOverview")</span><span class="sxs-lookup"><span data-stu-id="8d496-119">![External RuleSet Sample Conceptual Overview](./media/rulesettoolkitsampleoverview.gif "RuleSetToolkitSampleOverview")</span></span>

<span data-ttu-id="8d496-120">Abbildung 1: Beispielübersicht</span><span class="sxs-lookup"><span data-stu-id="8d496-120">Figure 1: Sample Overview</span></span>

> [!IMPORTANT]
> <span data-ttu-id="8d496-121">Die Beispiele sind möglicherweise bereits auf dem Computer installiert.</span><span class="sxs-lookup"><span data-stu-id="8d496-121">The samples may already be installed on your machine.</span></span> <span data-ttu-id="8d496-122">Suchen Sie nach dem folgenden Verzeichnis (Standardverzeichnis), bevor Sie fortfahren.</span><span class="sxs-lookup"><span data-stu-id="8d496-122">Check for the following (default) directory before continuing.</span></span>
>
> `<InstallDrive>:\WF_WCF_Samples`
>
> <span data-ttu-id="8d496-123">Wenn dieses Verzeichnis nicht vorhanden ist, fahren Sie mit [Windows Communication Foundation (WCF) und Windows Workflow Foundation (WF) Samples für .NET Framework 4](https://go.microsoft.com/fwlink/?LinkId=150780) alle Windows Communication Foundation (WCF) herunterladen und [!INCLUDE[wf1](../../../../includes/wf1-md.md)] Beispiele.</span><span class="sxs-lookup"><span data-stu-id="8d496-123">If this directory does not exist, go to [Windows Communication Foundation (WCF) and Windows Workflow Foundation (WF) Samples for .NET Framework 4](https://go.microsoft.com/fwlink/?LinkId=150780) to download all Windows Communication Foundation (WCF) and [!INCLUDE[wf1](../../../../includes/wf1-md.md)] samples.</span></span> <span data-ttu-id="8d496-124">Dieses Beispiel befindet sich im folgenden Verzeichnis.</span><span class="sxs-lookup"><span data-stu-id="8d496-124">This sample is located in the following directory.</span></span>
>
> `<InstallDrive>:\WF_WCF_Samples\WF\Scenario\ExternalRuleSetToolKit`

## <a name="ruleset-tool"></a><span data-ttu-id="8d496-125">RuleSet-Tool</span><span class="sxs-lookup"><span data-stu-id="8d496-125">RuleSet Tool</span></span>

<span data-ttu-id="8d496-126">Eine Bildschirmabbildung des RuleSet-Tools ist in Abbildung 2 dargestellt.</span><span class="sxs-lookup"><span data-stu-id="8d496-126">A screen shot of the RuleSet tool is shown in Figure 2.</span></span> <span data-ttu-id="8d496-127">Von der **Regel Store** Menü können Sie die verfügbaren RuleSets aus der Datenbank laden und geänderten ruleSets im Speicher.</span><span class="sxs-lookup"><span data-stu-id="8d496-127">From the **Rule Store** menu, you can load the available RuleSets from the database and save modified RuleSets back to the store.</span></span> <span data-ttu-id="8d496-128">Eine Anwendungskonfigurationsdatei stellt eine Datenbank-Verbindungszeichenfolge für die RuleSet-Datenbank bereit.</span><span class="sxs-lookup"><span data-stu-id="8d496-128">An application configuration file provides a database connection string for the RuleSet database.</span></span> <span data-ttu-id="8d496-129">Wenn Sie das Tool starten, werden die RuleSets automatisch aus der konfigurierten Datenbank geladen.</span><span class="sxs-lookup"><span data-stu-id="8d496-129">When you start the tool, it automatically loads the RuleSets from the configured database.</span></span>

<span data-ttu-id="8d496-130">![Ausgabe eines externen RuleSet-Toolkitbeispiels](./media/rulesetbrowser.gif "RuleSetBrowser")</span><span class="sxs-lookup"><span data-stu-id="8d496-130">![External RuleSet Toolkit Sample output](./media/rulesetbrowser.gif "RuleSetBrowser")</span></span>

<span data-ttu-id="8d496-131">Abbildung 2: RuleSet-Browser</span><span class="sxs-lookup"><span data-stu-id="8d496-131">Figure 2: RuleSet Browser</span></span>

<span data-ttu-id="8d496-132">Das RuleSet-Tool weist den RuleSets Haupt- und Nebenversionsnummern zu, wodurch Sie mehrere Versionen gleichzeitig verwalten und speichern können (das Tool bietet keinen Sperrmechanismus oder andere Konfigurationsverwaltungsfunktionen zusätzlich zur Versionsverwaltungsoption).</span><span class="sxs-lookup"><span data-stu-id="8d496-132">The RuleSet tool applies major and minor version numbers to the RuleSets, allowing you to simultaneously maintain and store multiple versions (the tool provides no locking or other configuration management features in addition to the versioning capability).</span></span> <span data-ttu-id="8d496-133">Mit dem Tool können Sie neue RuleSet-Versionen erstellen oder vorhandene Versionen löschen.</span><span class="sxs-lookup"><span data-stu-id="8d496-133">Using the tool, you can create new RuleSet versions or delete existing versions.</span></span> <span data-ttu-id="8d496-134">Beim Klicken auf **neu**, das Tool erstellt einen neuen RuleSet-Namen und übernimmt Version 1.0.</span><span class="sxs-lookup"><span data-stu-id="8d496-134">When you click **New**, the tool creates a new RuleSet name and applies version 1.0.</span></span> <span data-ttu-id="8d496-135">Wenn Sie eine Version kopieren, erstellt das Tool eine Kopie der ausgewählten RuleSet-Version, einschließlich der enthaltenen Regeln, und weist neue, eindeutige Versionsnummern zu.</span><span class="sxs-lookup"><span data-stu-id="8d496-135">When you copy a version, the tool creates a copy of the selected RuleSet version, including the contained rules, and assigns new, unique version numbers.</span></span> <span data-ttu-id="8d496-136">Diese Versionsnummern basieren auf den Versionsnummern von vorhandenen RuleSets.</span><span class="sxs-lookup"><span data-stu-id="8d496-136">These version numbers are based on the version numbers of existing RuleSets.</span></span> <span data-ttu-id="8d496-137">Sie können den RuleSet-Namen und die Versionsnummern mit den zugeordneten Feldern des Formulars ändern.</span><span class="sxs-lookup"><span data-stu-id="8d496-137">You can change the RuleSet name and version numbers using the associated fields on the form.</span></span>

<span data-ttu-id="8d496-138">Beim Klicken auf **Bearbeiten von Regeln**, startet der RuleSet-Editor, wie in Abbildung 3 dargestellt.</span><span class="sxs-lookup"><span data-stu-id="8d496-138">When you click **Edit Rules**, the RuleSet editor starts, as shown in Figure 3.</span></span>

<span data-ttu-id="8d496-139">![Externes RuleSet-Toolkit-Beispielausgabe](./media/ruleseteditor.gif "RuleSetEditor")</span><span class="sxs-lookup"><span data-stu-id="8d496-139">![External RuleSet Toolkit Sample Output](./media/ruleseteditor.gif "RuleSetEditor")</span></span>

<span data-ttu-id="8d496-140">Abbildung 3: RuleSet-Editor</span><span class="sxs-lookup"><span data-stu-id="8d496-140">Figure 3: RuleSet Editor</span></span>

<span data-ttu-id="8d496-141">Dies ist ein rehosting im Editor-Dialogfeld, das Teil des Visual Studio für Windows Workflow Foundation-add-Ins ist.</span><span class="sxs-lookup"><span data-stu-id="8d496-141">This is a re-hosting of the editor dialog that is part of the Windows Workflow Foundation Visual Studio add-in.</span></span> <span data-ttu-id="8d496-142">Es stellt die gleiche Funktionalität bereit, einschließlich der Intellisense-Unterstützung.</span><span class="sxs-lookup"><span data-stu-id="8d496-142">It provides the same functionality, including Intellisense support.</span></span> <span data-ttu-id="8d496-143">Die Regeln werden anhand eines Zieltyps (z. B. eines Workflows) erstellt, die dem RuleSet im Tool zugeordnet ist; Beim Klicken auf **Durchsuchen** in des Hauptdialogfelds der **Workflow/Type Selector** Dialogfeld wird angezeigt, wie in Abbildung 4 dargestellt.</span><span class="sxs-lookup"><span data-stu-id="8d496-143">The rules are authored against a target type (such as a workflow) that is associated with the RuleSet in the tool; when you click **Browse** in the main tool dialog, the **Workflow/Type Selector** dialog appears, as shown in Figure 4.</span></span>

<span data-ttu-id="8d496-144">![Workflow &#47;Auswahl geben](./media/71f08d57-e8f2-499e-8151-ece2cbdcabfd.gif "71f08d57-e8f2-499e-8151-ece2cbdcabfd")</span><span class="sxs-lookup"><span data-stu-id="8d496-144">![Workflow &#47;Type Selection](./media/71f08d57-e8f2-499e-8151-ece2cbdcabfd.gif "71f08d57-e8f2-499e-8151-ece2cbdcabfd")</span></span>

<span data-ttu-id="8d496-145">Abbildung 4: Workflow-/Typenauswahl</span><span class="sxs-lookup"><span data-stu-id="8d496-145">Figure 4: Workflow/Type Selector</span></span>

<span data-ttu-id="8d496-146">Sie können die **Workflow/Type Selector** Dialogfeld, um eine Assembly und einen bestimmten Typ innerhalb dieser Assembly angeben.</span><span class="sxs-lookup"><span data-stu-id="8d496-146">You can use the **Workflow/Type Selector** dialog to specify an assembly and a specific type within that assembly.</span></span> <span data-ttu-id="8d496-147">Dieser Typ ist der Zieltyp, für den die Regeln entwickelt (und ausgeführt) werden.</span><span class="sxs-lookup"><span data-stu-id="8d496-147">This type is the target type against which the rules are authored (and run).</span></span> <span data-ttu-id="8d496-148">In vielen Fällen ist der Zieltyp ein Workflow oder ein anderer Aktivitätstyp.</span><span class="sxs-lookup"><span data-stu-id="8d496-148">In many cases, the target type is a workflow or some other activity type.</span></span> <span data-ttu-id="8d496-149">Sie können jedoch für jeden .NET-Typ ein RuleSet ausführen.</span><span class="sxs-lookup"><span data-stu-id="8d496-149">However, you can run a RuleSet against any .NET type.</span></span>

<span data-ttu-id="8d496-150">Der Pfad der Assemblydatei und der Typname `name are stored with the` RuleSet in der Datenbank, sodass Wenn RuleSet aus der Datenbank abgerufen wird das Tool versucht, automatisch den Zieltyp lädt.</span><span class="sxs-lookup"><span data-stu-id="8d496-150">The path to the assembly file and the type `name are stored with the` RuleSet in the database, so that when the RuleSet is retrieved from the database, the tool attempts to automatically load the target type.</span></span>

<span data-ttu-id="8d496-151">Beim Klicken auf **OK** in die **Workflow/Type Selector** Dialogfeld überprüft den ausgewählten Typ anhand des RuleSet aus, um sicherzustellen, dass der Zieltyp alle Elemente, die von den Regeln verwiesen wird.</span><span class="sxs-lookup"><span data-stu-id="8d496-151">When you click **OK** in the **Workflow/Type Selector** dialog, it validates the selected type against the RuleSet, to ensure that the target type has all the members referenced by the rules.</span></span> <span data-ttu-id="8d496-152">Fehler werden angezeigt, einem **Validierungsfehler** Dialogfeld (siehe Abbildung 5).</span><span class="sxs-lookup"><span data-stu-id="8d496-152">Errors are shown in a **Validation Errors** dialog (see Figure 5).</span></span> <span data-ttu-id="8d496-153">Sie können trotz der Fehler mit der Änderung fortfahren oder auf **Abbrechen**.</span><span class="sxs-lookup"><span data-stu-id="8d496-153">You can choose to continue with the change despite the errors, or click **Cancel**.</span></span> <span data-ttu-id="8d496-154">Von der **Tools** Menü im Hauptdialogfeld des Tools, die Sie klicken können **überprüfen** die RuleSet-Version anhand der Zielaktivität erneut zu überprüfen.</span><span class="sxs-lookup"><span data-stu-id="8d496-154">From the **Tools** menu in the main tool dialog, you can click **Validate** to re-validate the RuleSet version against the target activity.</span></span>

<span data-ttu-id="8d496-155">![Validierungsfehler vom externen RuleSet-Beispiel](./media/validationerrorsruleset.png "ValidationErrorsRuleSet")</span><span class="sxs-lookup"><span data-stu-id="8d496-155">![Validation Errors from External RuleSet Sample](./media/validationerrorsruleset.png "ValidationErrorsRuleSet")</span></span>

<span data-ttu-id="8d496-156">Abbildung 5: Validierungsfehler</span><span class="sxs-lookup"><span data-stu-id="8d496-156">Figure 5: Validation Errors</span></span>

<span data-ttu-id="8d496-157">Von der **Daten** Menü Tool für die Sie importieren und exportieren Sie die RuleSets.</span><span class="sxs-lookup"><span data-stu-id="8d496-157">From the **Data** menu in the tool, you can import and export RuleSets.</span></span> <span data-ttu-id="8d496-158">Beim Klicken auf **Import**, ein Dateiauswahl-Dialogfeld angezeigt wird, von dem Sie eine rules-Datei auswählen können.</span><span class="sxs-lookup"><span data-stu-id="8d496-158">When you click **Import**, a file-chooser dialog appears, from which you can select a .rules file.</span></span> <span data-ttu-id="8d496-159">Dies kann oder möglicherweise nicht in eine Datei, die zunächst in Visual Studio erstellt.</span><span class="sxs-lookup"><span data-stu-id="8d496-159">This may or may not be a file initially created in Visual Studio.</span></span> <span data-ttu-id="8d496-160">Die RULES-Datei sollte eine serialisierte `RuleDefinitions`-Instanz enthalten, die wiederum eine Auflistung der Bedingungen und RuleSets enthält.</span><span class="sxs-lookup"><span data-stu-id="8d496-160">The .rules file should contain a serialized `RuleDefinitions` instance that contains a collection of conditions and a collection of RuleSets.</span></span> <span data-ttu-id="8d496-161">Das Tool verwendet keine der bedingungenauflistung es unterstützt jedoch die Verwendung der `RuleDefinitions` Rules-Format, um die Interaktion mit der Visual Studio-Umgebung zu ermöglichen.</span><span class="sxs-lookup"><span data-stu-id="8d496-161">The tool does not use the conditions collection, but it does use the `RuleDefinitions` .rules format to allow interaction with the Visual Studio environment.</span></span>

<span data-ttu-id="8d496-162">Nach der Auswahl einer rules-Datei eine **RuleSet-Selektor** angezeigt (siehe Abbildung 6).</span><span class="sxs-lookup"><span data-stu-id="8d496-162">After selecting a .rules file, a **RuleSet Selector** dialog appears (see Figure 6).</span></span> <span data-ttu-id="8d496-163">Mit dem Dialogfeld können Sie die RuleSets aus der Datei auswählen, die Sie importieren möchten (als Standard sind alle RuleSets angegeben).</span><span class="sxs-lookup"><span data-stu-id="8d496-163">You can use the dialog to select the RuleSets from the file that you want to import (the default specifies all RuleSets).</span></span> <span data-ttu-id="8d496-164">Die RuleSets in der RULES-Datei weisen keine Versionsnummern auf, da ihre Versionsverwaltung in einem WF-Projekt der Version der Assembly entspricht.</span><span class="sxs-lookup"><span data-stu-id="8d496-164">RuleSets in the .rules file do not have version numbers, because their versioning within a WF project is the same as the version of the assembly.</span></span> <span data-ttu-id="8d496-165">Während des Importvorgangs weist das Tool automatisch die nächste verfügbare Hauptversionsnummer (die Sie nach dem Import ändern können); sehen Sie die zugewiesenen Versionsnummern in der **RuleSet-Selektor** Liste.</span><span class="sxs-lookup"><span data-stu-id="8d496-165">During the importing process, the tool automatically assigns the next available major version number (which you can change after importing); you can see the assigned version numbers in the **RuleSet Selector** list.</span></span>

<span data-ttu-id="8d496-166">Für jedes importierte RuleSet versucht das Tool, den zugeordneten Typ im Ordner bin\Debug unterhalb des Verzeichnisses der RULES-Datei (falls vorhanden) basierend auf den im RuleSet verwendeten Membern zu finden.</span><span class="sxs-lookup"><span data-stu-id="8d496-166">For each RuleSet it imports, the tool attempts to locate the associated type from the bin\Debug folder under the location of the .rules file (if it exists), based on the members used in the RuleSet.</span></span> <span data-ttu-id="8d496-167">Falls mehrere passende Typen gefunden werden, versucht das Tool, einen Typ basierend auf einer Übereinstimmung zwischen der RULES-Datei und dem Typnamen zu finden (z.&#160;B. entspricht der `Workflow1`-Typ Workflow1.rules).</span><span class="sxs-lookup"><span data-stu-id="8d496-167">If the tool finds multiple matching types, it attempts to choose a type based on a match between the .rules file name and the type name (for example, the `Workflow1` type corresponds to Workflow1.rules).</span></span> <span data-ttu-id="8d496-168">Wenn mehrere Übereinstimmungen vorhanden sind, werden Sie aufgefordert, den Typ auszuwählen.</span><span class="sxs-lookup"><span data-stu-id="8d496-168">If multiple matches exist, you are prompted to select the type.</span></span> <span data-ttu-id="8d496-169">Wenn dieser Mechanismus für die automatische Identifizierung keine übereinstimmende Assembly oder keinen ersten Typ findet, nach dem Import können Sie auf **Durchsuchen** auf des Hauptdialogfelds, an den zugeordneten Typ zu navigieren.</span><span class="sxs-lookup"><span data-stu-id="8d496-169">If this auto-identification mechanism fails to locate a matching assembly or type, then after importing you can click **Browse** on the main tool dialog to navigate to the associated type.</span></span>

<span data-ttu-id="8d496-170">![RuleSet-Selektor](./media/rulesetselector.gif "RuleSetSelector")</span><span class="sxs-lookup"><span data-stu-id="8d496-170">![Ruleset selector](./media/rulesetselector.gif "RuleSetSelector")</span></span>

<span data-ttu-id="8d496-171">Abbildung 6: RuleSet-Selektor</span><span class="sxs-lookup"><span data-stu-id="8d496-171">Figure 6: RuleSet Selector</span></span>

<span data-ttu-id="8d496-172">Beim Klicken auf **Data-Export** im Hauptdialogfeld des Tools-Menü die **RuleSet-Selektor** Dialogfeld erneut angezeigt, von dem Sie die RuleSets aus der Datenbank bestimmen können, die exportiert werden sollen.</span><span class="sxs-lookup"><span data-stu-id="8d496-172">When you click **Data-Export** from the main tool menu, the **RuleSet Selector** dialog appears again, from which you can determine the RuleSets from the database that should be exported.</span></span> <span data-ttu-id="8d496-173">Beim Klicken auf **OK**, **Datei speichern** Dialogfeld wird angezeigt, in dem Sie den Namen und Speicherort der resultierenden rules-Datei angeben können.</span><span class="sxs-lookup"><span data-stu-id="8d496-173">When you click **OK**, a **Save File** dialog appears, in which you can specify the name and location of the resulting .rules file.</span></span> <span data-ttu-id="8d496-174">Da die RULES-Datei keine Versionsinformationen enthält, können Sie lediglich eine RuleSet-Version mit einem bestimmten RuleSet-Namen auswählen.</span><span class="sxs-lookup"><span data-stu-id="8d496-174">Because the .rules file does not contain version information, you can only select one RuleSet version with a given RuleSet name.</span></span>

## <a name="policyfromservice-activity"></a><span data-ttu-id="8d496-175">PolicyFromService-Aktivität</span><span class="sxs-lookup"><span data-stu-id="8d496-175">PolicyFromService Activity</span></span>

<span data-ttu-id="8d496-176">Der Code für die `PolicyFromService`-Aktivität ist einfach.</span><span class="sxs-lookup"><span data-stu-id="8d496-176">The code for the `PolicyFromService` activity is straightforward.</span></span> <span data-ttu-id="8d496-177">Er funktioniert wie die mit WF bereitgestellte `Policy`-Aktivität. Statt jedoch das Ziel-RuleSet aus der RULES-Datei abzurufen, wird ein Hostdienst zum Abrufen der RuleSet-Instanz aufgerufen.</span><span class="sxs-lookup"><span data-stu-id="8d496-177">It works much like the `Policy` activity provided with WF, but instead of retrieving the target RuleSet from the .rules file, it calls a host service to obtain the RuleSet instance.</span></span> <span data-ttu-id="8d496-178">Anschließend wird das RuleSet für die Stammaktivität der Workflowinstanz ausgeführt.</span><span class="sxs-lookup"><span data-stu-id="8d496-178">It then runs the RuleSet against the root workflow activity instance.</span></span>

<span data-ttu-id="8d496-179">Um die Aktivität in einem Workflow zu verwenden, fügen Sie der `PolicyActivities`-Assembly und der `RuleSetService`-Assembly aus dem Workflowprojekt einen Verweis hinzu.</span><span class="sxs-lookup"><span data-stu-id="8d496-179">To use the activity in a workflow, add a reference to the `PolicyActivities` and `RuleSetService` assemblies from your workflow project.</span></span> <span data-ttu-id="8d496-180">Weitere Informationen erhalten Sie in dem am Ende dieses Themas beschriebenen Verfahren über das Hinzufügen der Aktivität zur Toolbox.</span><span class="sxs-lookup"><span data-stu-id="8d496-180">See the procedure at the end of this topic for a discussion of how to add the activity to the toolbox.</span></span>

<span data-ttu-id="8d496-181">Nachdem die Aktivität in Ihren Workflow integriert wurde, müssen Sie den Namen des auszuführenden RuleSet angeben.</span><span class="sxs-lookup"><span data-stu-id="8d496-181">After placing the activity in your workflow, you must provide the name of the RuleSet to be run.</span></span> <span data-ttu-id="8d496-182">Sie können den Wert als Literalwert angeben oder an eine Workflowvariable oder Eigenschaft einer anderen Aktivität binden.</span><span class="sxs-lookup"><span data-stu-id="8d496-182">You can enter the name as a literal value, or bind to a workflow variable or property of another activity.</span></span> <span data-ttu-id="8d496-183">Optional können Sie für das auszuführende RuleSet Versionsnummern eingeben.</span><span class="sxs-lookup"><span data-stu-id="8d496-183">Optionally, you can enter version numbers for the specific RuleSet that should be run.</span></span> <span data-ttu-id="8d496-184">Falls Sie den Standardwert 0 für die Haupt- und Nebenversionsnummern unverändert lassen, wird in der Datenbank für die Aktivität automatisch die neueste Versionsnummer verwendet.</span><span class="sxs-lookup"><span data-stu-id="8d496-184">If you leave the default value of 0 for the major and minor version numbers, the latest version number in the database is automatically provided for the activity.</span></span>

## <a name="ruleset-service"></a><span data-ttu-id="8d496-185">RuleSet-Dienst</span><span class="sxs-lookup"><span data-stu-id="8d496-185">RuleSet Service</span></span>

<span data-ttu-id="8d496-186">Der Dienst ist für das Abrufen der angegebenen RuleSet-Version aus der Datenbank und das Zurückgeben an die aufrufende Aktivität verantwortlich.</span><span class="sxs-lookup"><span data-stu-id="8d496-186">The service is responsible for retrieving the specified RuleSet version from the database and returning it to the calling activity.</span></span> <span data-ttu-id="8d496-187">Wie zuvor bereits erläutert, ruft der Dienst die neueste Version ab, falls der Haupt- und der Nebenversionswert, die beim `GetRuleSet`-Aufruf übergeben werden, beide 0 betragen.</span><span class="sxs-lookup"><span data-stu-id="8d496-187">As previously discussed, if the major and minor version values passed in the `GetRuleSet` call are both 0, the service retrieves the latest version.</span></span> <span data-ttu-id="8d496-188">An diesem Punkt werden keine RuleSet-Definitionen oder Instanzen zwischengespeichert. Außerdem gibt es keine Features zum Kennzeichnen von RuleSet-Versionen als "bereitgestellt", um sie von aktuell verarbeiteten RuleSets zu unterscheiden.</span><span class="sxs-lookup"><span data-stu-id="8d496-188">At this point, there is no caching of RuleSet definitions or instances; similarly, there are no features for marking RuleSet versions as "deployed" to differentiate them from in-progress RuleSets.</span></span>

<span data-ttu-id="8d496-189">Die Datenbank, auf die vom Dienst zugegriffen werden soll, sollte anhand einer Anwendungskonfigurationsdatei auf dem Host konfiguriert werden.</span><span class="sxs-lookup"><span data-stu-id="8d496-189">The database to be accessed by the service should be configured on the host using an application configuration file.</span></span>

#### <a name="to-run-the-tool"></a><span data-ttu-id="8d496-190">So führen Sie das Tool aus</span><span class="sxs-lookup"><span data-stu-id="8d496-190">To run the tool</span></span>

1. <span data-ttu-id="8d496-191">Der Ordner, mit dem die vom Tool und Dienst verwendete RuleSet-Tabelle eingerichtet wird, enthält eine Setup.sql-Datei.</span><span class="sxs-lookup"><span data-stu-id="8d496-191">The folder that sets up the RuleSet table used by the tool and the service contains a Setup.sql file.</span></span> <span data-ttu-id="8d496-192">Sie können die Setup.cmd-Batchdatei ausführen, um die Regeldatenbank in SQL Express zu erstellen und die RuleSet-Tabelle einzurichten.</span><span class="sxs-lookup"><span data-stu-id="8d496-192">You can run the Setup.cmd batch file to create the Rules database on SQL Express and to set up the RuleSet table.</span></span>

2. <span data-ttu-id="8d496-193">Falls Sie die Batchdatei oder Setup.sql bearbeiten und festlegen, dass SQL Express nicht verwendet wird oder dass die Tabelle in einer Datenbank mit einem anderen Namen als `Rules` abgelegt werden soll, sollten die Anwendungskonfigurationsdateien im RuleSet-Tool und die `UsageSample`-Projekte mit denselben Informationen bearbeitet werden.</span><span class="sxs-lookup"><span data-stu-id="8d496-193">If you edit the batch file or Setup.sql and specify not to use SQL Express or to place the table in a database named something other than `Rules`, the application configuration files in the RuleSet tool and `UsageSample` projects should be edited with the same information.</span></span>

3. <span data-ttu-id="8d496-194">Nachdem Sie das Setup.sql-Skript ausgeführt haben, können Sie die `ExternalRuleSetToolkit`-Projektmappe erstellen und das RuleSet-Tool aus dem ExternalRuleSetTool-Projekt starten.</span><span class="sxs-lookup"><span data-stu-id="8d496-194">After you run the Setup.sql script, you can build the `ExternalRuleSetToolkit` solution and then launch the RuleSet tool from the ExternalRuleSetTool project.</span></span>

4. <span data-ttu-id="8d496-195">Die Projektmappe der `RuleSetToolkitUsageSample`-Konsolenanwendung für sequentielle Workflows schließt einen Beispielworkflow ein.</span><span class="sxs-lookup"><span data-stu-id="8d496-195">The `RuleSetToolkitUsageSample` Sequential Workflow Console Application solution includes a sample workflow.</span></span> <span data-ttu-id="8d496-196">Der Workflow besteht aus einer `PolicyFromService`-Aktivität und zwei Variablen, `orderValue` und `discount`, für die das Ziel-RuleSet ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="8d496-196">The workflow consists of a `PolicyFromService` activity and two variables, `orderValue` and `discount`, against which the target RuleSet runs.</span></span>

5. <span data-ttu-id="8d496-197">Um das Beispiel zu verwenden, erstellen Sie die `RuleSetToolkitUsageSample`-Projektmappe.</span><span class="sxs-lookup"><span data-stu-id="8d496-197">To use the sample, build the `RuleSetToolkitUsageSample` solution.</span></span> <span data-ttu-id="8d496-198">Klicken Sie dann auf klicken Sie im Hauptmenü RuleSet-Tool **Datenimport** und zeigen Sie auf die Datei discountruleset.Rules im Ordner RuleSetToolkitUsageSample.</span><span class="sxs-lookup"><span data-stu-id="8d496-198">Then from the RuleSet tool main menu, click **Data-Import** and point to the DiscountRuleSet.rules file in the RuleSetToolkitUsageSample folder.</span></span> <span data-ttu-id="8d496-199">Klicken Sie auf die **Rule Store speichern** Menüoption aus, um das importierte RuleSet in der Datenbank zu speichern.</span><span class="sxs-lookup"><span data-stu-id="8d496-199">Click the **Rule Store-Save** menu option to save the imported RuleSet to the database.</span></span>

6. <span data-ttu-id="8d496-200">Da die `PolicyActivities`-Assembly im Beispielworkflowprojekt referenziert wird, wird die `PolicyFromService`-Aktivität im Workflow angezeigt.</span><span class="sxs-lookup"><span data-stu-id="8d496-200">Because the `PolicyActivities` assembly is referenced from the sample workflow project, the `PolicyFromService` activity appears in the workflow.</span></span> <span data-ttu-id="8d496-201">Sie wird jedoch nicht standardmäßig in der Toolbox angezeigt.</span><span class="sxs-lookup"><span data-stu-id="8d496-201">It does not, however, appear in the toolbox by default.</span></span> <span data-ttu-id="8d496-202">Falls Sie sie der Toolbox hinzufügen möchten, gehen Sie wie folgt vor:</span><span class="sxs-lookup"><span data-stu-id="8d496-202">To add it to the toolbox, do the following:</span></span>

    - <span data-ttu-id="8d496-203">Mit der rechten Maustaste in der Toolbox, und wählen Sie **Elemente auswählen** (Dies kann eine Weile dauern).</span><span class="sxs-lookup"><span data-stu-id="8d496-203">Right-click the toolbox and select **Choose Items** (this may take a while).</span></span>

    - <span data-ttu-id="8d496-204">Wenn die **Toolboxelemente** Dialogfeld erscheint, klicken Sie auf der **Aktivitäten** Registerkarte.</span><span class="sxs-lookup"><span data-stu-id="8d496-204">When the **Choose Toolbox Items** dialog appears, click the **Activities** tab.</span></span>

    - <span data-ttu-id="8d496-205">Navigieren Sie zu der `PolicyActivities` Assembly in den `ExternalRuleSetToolkit` Lösung, und klicken Sie auf **öffnen**.</span><span class="sxs-lookup"><span data-stu-id="8d496-205">Browse to the `PolicyActivities` assembly in the `ExternalRuleSetToolkit` solution and click **Open**.</span></span>

    - <span data-ttu-id="8d496-206">Sicherstellen, dass die `PolicyFromService` Aktivität ausgewählt ist, der **Toolboxelemente auswählen** Dialogfeld, und klicken Sie dann auf **OK**.</span><span class="sxs-lookup"><span data-stu-id="8d496-206">Ensure that the `PolicyFromService` activity is selected in the **Choose Toolbox Items** dialog and then click **OK**.</span></span>

    - <span data-ttu-id="8d496-207">Die Aktivität sollte jetzt angezeigt werden, in der Toolbox in die **RuleSetToolkitUsageSample-Komponenten** Kategorie.</span><span class="sxs-lookup"><span data-stu-id="8d496-207">The activity should now appear in the toolbox in the **RuleSetToolkitUsageSample Components** category.</span></span>

7. <span data-ttu-id="8d496-208">Der RuleSet-Dienst ist bereits mit der folgenden Anweisung in Program.cs auf dem Konsolenanwendungshost konfiguriert.</span><span class="sxs-lookup"><span data-stu-id="8d496-208">The RuleSet service is already configured on the console application host using the following statement in Program.cs.</span></span>

    ```csharp
    workflowRuntime.AddService(new RuleSetService());
    ```

8. <span data-ttu-id="8d496-209">Sie können den Dienst auch anhand einer Konfigurationsdatei auf dem Host konfigurieren. Weitere Informationen finden Sie in der SDK-Dokumentation.</span><span class="sxs-lookup"><span data-stu-id="8d496-209">You can also configure the service on the host using a configuration file; see the SDK documentation for details.</span></span>

9. <span data-ttu-id="8d496-210">Dem Workflowprojekt wird eine Anwendungskonfigurationsdatei hinzugefügt, um die Verbindungszeichenfolge für die vom Dienst zu verwendende Datenbank anzugeben.</span><span class="sxs-lookup"><span data-stu-id="8d496-210">An application configuration file is added to the workflow project to specify the connection string for the database to be used by the service.</span></span> <span data-ttu-id="8d496-211">Dabei sollte es sich um dieselbe Verbindungszeichenfolge handeln, die vom RuleSet-Tool verwendet wird und die auf die Datenbank verweist, welche die RuleSet-Tabelle enthält.</span><span class="sxs-lookup"><span data-stu-id="8d496-211">This should be the same connection string used by the RuleSet tool, which points to the database that contains the RuleSet table.</span></span>

10. <span data-ttu-id="8d496-212">Sie können jetzt das `RuleSetToolkitUsageSample`-Projekt so ausführen, wie Sie jede andere Workflowkonsolenanwendung ausführen würden.</span><span class="sxs-lookup"><span data-stu-id="8d496-212">You can now run the `RuleSetToolkitUsageSample` project as you would any other workflow console application.</span></span> <span data-ttu-id="8d496-213">Drücken Sie F5 oder STRG + F5 in Visual Studio, oder führen Sie die Datei RuleSetToolkitUsageSample.exe direkt.</span><span class="sxs-lookup"><span data-stu-id="8d496-213">Press F5 or Ctrl+F5 within Visual Studio or run the RuleSetToolkitUsageSample.exe file directly.</span></span>

    > [!NOTE]
    > <span data-ttu-id="8d496-214">Sie müssen das RuleSet-Tool schließen, um das Anwendungsbeispiel erneut zu kompilieren, da die Anwendungsbeispielassembly vom Tool geladen wird.</span><span class="sxs-lookup"><span data-stu-id="8d496-214">You must close the RuleSet tool to recompile the usage sample, because the tool loads the usage sample assembly.</span></span>
