---
ms.openlocfilehash: 5850e3359dab6503d5745a2266c7bf77780e5cc0
ms.sourcegitcommit: 0aca6c5d166d7961a1e354c248495645b97a1dc5
ms.translationtype: HT
ms.contentlocale: de-DE
ms.lasthandoff: 04/01/2019
ms.locfileid: "58760825"
---
### <a name="avoiding-endless-recursion-for-iworkflowinstancemanagementtransactedcancel-and-iworkflowinstancemanagementtransactedterminate"></a><span data-ttu-id="b9b8e-101">Vermeiden von Endlosrekursion für IWorkflowInstanceManagement.TransactedCancel und IWorkflowInstanceManagement.TransactedTerminate</span><span class="sxs-lookup"><span data-stu-id="b9b8e-101">Avoiding endless recursion for IWorkflowInstanceManagement.TransactedCancel and IWorkflowInstanceManagement.TransactedTerminate</span></span>

|   |   |
|---|---|
|<span data-ttu-id="b9b8e-102">Details</span><span class="sxs-lookup"><span data-stu-id="b9b8e-102">Details</span></span>|<span data-ttu-id="b9b8e-103">Wenn Sie <xref:System.ServiceModel.Activities.IWorkflowInstanceManagement.TransactedCancel%2A?displayProperty=nameWithType>- oder <xref:System.ServiceModel.Activities.IWorkflowInstanceManagement.TransactedTerminate%2A?displayProperty=nameWithType>-APIs verwenden, um eine Worklowdienstinstanz abzubrechen oder zu beenden, kann für die Workflowinstanz unter bestimmten Umständen aufgrund von Endlosrekursion ein Stapelüberlauf auftreten, wenn die <code>Workflow</code>-Laufzeit versucht, die Dienstinstanz als Teil der Verarbeitung der Anforderung persistent zu speichern.</span><span class="sxs-lookup"><span data-stu-id="b9b8e-103">Under some circumstances when using <xref:System.ServiceModel.Activities.IWorkflowInstanceManagement.TransactedCancel%2A?displayProperty=nameWithType> or <xref:System.ServiceModel.Activities.IWorkflowInstanceManagement.TransactedTerminate%2A?displayProperty=nameWithType> APIs to cancel or terminate a workflow service instance, the workflow instance may encounter a stack overflow due to endless recursion when the <code>Workflow</code> runtime attempts to persist the service instance as part of processing the request.</span></span> <span data-ttu-id="b9b8e-104">Das Problem tritt auf, wenn sich die Workflowinstanz in einem Zustand befindet, in dem sie auf den Abschluss einer anderen ausstehenden WCF-Anforderung an einen anderen Dienst wartet. Die <code>TransactedCancel</code>- und <code>TransactedTerminate</code>-Vorgänge erstellen Arbeitselemente, die für die Workflowdienstinstanz in die Warteschlange eingereiht werden.</span><span class="sxs-lookup"><span data-stu-id="b9b8e-104">The problem occurs if the workflow instance is in a state where it is waiting for some other outstanding WCF request to another service to complete.The <code>TransactedCancel</code> and <code>TransactedTerminate</code> operations create work items that are queued for the workflow service instance.</span></span> <span data-ttu-id="b9b8e-105">Diese Arbeitselemente werden nicht im Rahmen der Verarbeitung der <code>TransactedCancel/TransactedTerminate</code>-Anforderung ausgeführt.</span><span class="sxs-lookup"><span data-stu-id="b9b8e-105">These work items are not executed as part of the processing of the <code>TransactedCancel/TransactedTerminate</code> request.</span></span> <span data-ttu-id="b9b8e-106">Da die Workflowdienstinstanz damit ausgelastet ist, auf den Abschluss der anderen ausstehenden WCF-Anforderung zu warten, verbleibt das erstellte Arbeitselement in der Warteschlange.</span><span class="sxs-lookup"><span data-stu-id="b9b8e-106">Because the workflow service instance is busy waiting for the other outstanding WCF request to complete, the work item created remains queued.</span></span> <span data-ttu-id="b9b8e-107">Der <code>TransactedCancel/TransactedTerminate</code>-Vorgang wird abgeschlossen, und die Steuerung wird zurück an den Client übergeben.</span><span class="sxs-lookup"><span data-stu-id="b9b8e-107">The <code>TransactedCancel/TransactedTerminate</code> operation completes and control is returned back to the client.</span></span> <span data-ttu-id="b9b8e-108">Wenn die dem <code>TransactedCancel/TransactedTerminate</code>-Vorgang zugeordnete Transaktion den Commit versucht, muss sie den Zustand der Workflowdienstinstanz persistent speichern.</span><span class="sxs-lookup"><span data-stu-id="b9b8e-108">When the transaction associated with the <code>TransactedCancel/TransactedTerminate</code> operation attempts to commit, it needs to persist the workflow service instance state.</span></span> <span data-ttu-id="b9b8e-109">Da aber für die Instanz eine ausstehende <code>WCF</code>-Anforderung vorliegt, kann die Workflowruntime die Workflowdienstinstanz nicht persistent speichern, und eine Endlosrekursionsschleife führt zum Stapelüberlauf. Da <code>TransactedCancel</code> und <code>TransactedTerminate</code> nur ein Arbeitselement im Speicher erstellen, besitzt die Tatsache, dass eine Transaktion vorhanden ist, keinerlei Auswirkung.</span><span class="sxs-lookup"><span data-stu-id="b9b8e-109">But because there is an outstanding <code>WCF</code> request for the instance, the Workflow runtime cannot persist the workflow service instance, and an endless recursion loop leads to the stack overflow.Because <code>TransactedCancel</code> and <code>TransactedTerminate</code> only create a work item in memory, the fact that a transaction exists doesn't have any effect.</span></span> <span data-ttu-id="b9b8e-110">Durch ein Rollback der Transaktion wird das Arbeitselement nicht verworfen. Zur Lösung dieses Problems wurde ab .NET Framework 4.7.2 eine <code>AppSetting</code> eingeführt, die <code>web.config/app.config</code> des Workflowdiensts hinzugefügt werden kann und angibt, dass Transaktionen für <code>TransactedCancel</code> und <code>TransactedTerminate</code> ignoriert werden sollen.</span><span class="sxs-lookup"><span data-stu-id="b9b8e-110">A rollback of the transaction does not discard the work item.To address this issue, starting in .NET Framework 4.7.2, we have introduced an <code>AppSetting</code> that can be added to the <code>web.config/app.config</code> of the workflow service that tells it to ignore transactions for <code>TransactedCancel</code> and <code>TransactedTerminate</code>.</span></span> <span data-ttu-id="b9b8e-111">Auf diese Weise kann die Transaktion einen Commit auszuführen, ohne zu warten, bis die Workflowinstanz persistent gespeichert wurde. Die AppSetting für dieses Feature heißt <code>microsoft:WorkflowServices:IgnoreTransactionsForTransactedCancelAndTransactedTerminate</code>.</span><span class="sxs-lookup"><span data-stu-id="b9b8e-111">This allows the transaction to commit without waiting for the workflow instance to persist.The AppSetting for this feature is named <code>microsoft:WorkflowServices:IgnoreTransactionsForTransactedCancelAndTransactedTerminate</code>.</span></span> <span data-ttu-id="b9b8e-112">Der Wert <code>true</code> gibt an, dass die Transaktion ignoriert werden soll, um so den Stapelüberlauf zu vermeiden.</span><span class="sxs-lookup"><span data-stu-id="b9b8e-112">A value of <code>true</code> indicates that the transaction should be ignored, thus avoiding the stack overflow.</span></span> <span data-ttu-id="b9b8e-113">Der Standardwert dieser AppSetting ist <code>false</code>. Vorhandene Workflowdienstinstanzen sind daher nicht betroffen.</span><span class="sxs-lookup"><span data-stu-id="b9b8e-113">The default value of this AppSetting is <code>false</code>, so existing workflow service instances are not affected.</span></span>|
|<span data-ttu-id="b9b8e-114">Vorschlag</span><span class="sxs-lookup"><span data-stu-id="b9b8e-114">Suggestion</span></span>|<span data-ttu-id="b9b8e-115">Wenn Sie AppFabric oder einen anderen <xref:System.ServiceModel.Activities.IWorkflowInstanceManagement>-Client verwenden und beim Versuch, eine Workflowinstanz abzubrechen oder zu beenden, ein Stapelüberlauf in der Workflowdienstinstanz auftritt, können Sie Folgendes zum Abschnitt <code>&lt;appSettings&gt;</code> der Datei „web.config/app.config“ für den Workflowdienst hinzufügen:</span><span class="sxs-lookup"><span data-stu-id="b9b8e-115">If you are using AppFabric or another <xref:System.ServiceModel.Activities.IWorkflowInstanceManagement> client and are encountering a stack overflow in the workflow service instance when trying to cancel or terminate a workflow instance, you can add the following to the <code>&lt;appSettings&gt;</code> section of the web.config/app.config file for the workflow service:</span></span><pre><code class="lang-xml">&lt;add key=&quot;microsoft:WorkflowServices:IgnoreTransactionsForTransactedCancelAndTransactedTerminate&quot; value=&quot;true&quot;/&gt;&#13;&#10;</code></pre><span data-ttu-id="b9b8e-116">Wenn dieses Problem nicht auftritt, müssen Sie diese Aktion nicht ausführen.</span><span class="sxs-lookup"><span data-stu-id="b9b8e-116">If you are not encountering the problem, you do not need to do this.</span></span>|
|<span data-ttu-id="b9b8e-117">Bereich</span><span class="sxs-lookup"><span data-stu-id="b9b8e-117">Scope</span></span>|<span data-ttu-id="b9b8e-118">Microsoft Edge</span><span class="sxs-lookup"><span data-stu-id="b9b8e-118">Edge</span></span>|
|<span data-ttu-id="b9b8e-119">Version</span><span class="sxs-lookup"><span data-stu-id="b9b8e-119">Version</span></span>|<span data-ttu-id="b9b8e-120">4.7.2</span><span class="sxs-lookup"><span data-stu-id="b9b8e-120">4.7.2</span></span>|
|<span data-ttu-id="b9b8e-121">Typ</span><span class="sxs-lookup"><span data-stu-id="b9b8e-121">Type</span></span>|<span data-ttu-id="b9b8e-122">Neuzuweisung</span><span class="sxs-lookup"><span data-stu-id="b9b8e-122">Retargeting</span></span>|

